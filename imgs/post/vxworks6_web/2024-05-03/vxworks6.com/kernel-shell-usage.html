<!DOCTYPE HTML>
<html>
	<head>
		<title>Kernel Shell Usage</title>
		<link rel="icon" type="image/x-icon" href="images/favicon.ico">
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<!-- Code Highlight -->
		<link rel="stylesheet" type="text/css" href="codehl/prism.css"/>
		<script src="codehl/prism.js" type="text/javascript"> </script>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="index.html" class="logo"><strong>VxWorks</strong> RTOS</a>
									<ul class="icons">
										<li><a href="https://www.vxworks7.com" target="_blank" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
										<li><a href="https://www.vxworks.net" target="_blank" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
                                                                                <li><a href="https://www.gaitpu.com" target="_blank" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>

									</ul>
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Kernel Shell Usage</h1>
									</header>
                                                                </section>

									<!-- Content -->
										<div class="row">
											<div class="col-6 col-12-small">
												<span class="image"><img src="images/Kernel-Shell-Usage.png" alt="Kernel Shell Usage" /></span>
											</div>
											<div class="col-6 col-12-small">
												<h3>Learning Objectives</h3>
												<p>After this section you will be able to: </p>
												<ul>
													<li>Understand the C interpreter</li>
													<li>Understand the command interpreter</li>
													<li>Use some useful shell functions</li>
												</ul>
											</div>
										</div>

                                                                		<section>
                                                                        		<header class="major">
												<h2>The Two Shell Modes</h2>
                                                                        		</header>
                                                                		</section>
										<p>The kernel shell can use two modes: the C interpreter and the command interpreter. To switch between the two modes, you need to type the name of the interpreter into the shell. C for the C interpreter and cmd for the command interpreter.</p>
										<pre><code class="lang-bash">
-> cmd
[vxWorks *]# C
->
										</code></pre>
										<p>You can also type an interpreter's name before a command to execute a single command using that interpreter.</p>
										<pre><code class="lang-bash">
-> cmd
[vxWorks *]# C x=42
New Symbol “x” added to kernel symbol table.
value = 42 = 0x2a = '*' 
[vxWorks *]# C
->
										</code></pre>

                                                                		<section>
                                                                        		<header class="major">
												<h2>The C interpreter in VxWorks</h2>
                                                                        		</header>
                                                                		</section>

										<h3 id="content">The Features of the C Interpreter</h3>
										<ol>
											<li>The C interpreter is a useful prototyping and debugging tool within the kernel space.</li>
											<li>Any global variable can be manipulated to:</li>
											<ul>
												<li>Examine the values of program variables</li>
												<li>Change the values of variables</li>
												<li>Create new variables</li>
											</ul>
											<li>You can invoke almost any function in memory.</li>
											<ul>
												<li>When invoking a subroutine, the kernel shell passes ten arguments to the subroutine, padding with zeros if necessary.</li>
												<li>The shell prints the values of the function call (and other expressions) that it evaluates.</li>
											</ul>
										</ol>

										<h3 id="content">How to Evoke the C Interpreter</h3>
										<p>Type C (upper case) to start the C interpreter.</p>
										<p>The command syntax is generally the same as in the C language, as show in this example.</p>
										<div>
											<span class="image fit"><img src="images/C-interpreterer.png" alt="C Interpreterer" /></span>
										</div>

										<h3 id="content">Variables in the C Interpreter</h3>
										<ol>
											<li>The kernel shell creates new variables when a value is assigned to an undefined symbol.</li>
											<li>The interpreter looks for symbol and _symbol in the symbol table.</li>
											<li>The 32-bit VxWorks C interpreter interprets variables as <b>32-bit integers</b>, whereas the 64-bit VxWorks C interpreter interprets variables as <b>64-bit integers</b>.</li>
											<li>Use casts to tell the kernel shell how to interpret non-integer types.</li>
											<li>Casting is temporary – you must cast on each access.</li>
											<li>The C interpreter supports:</li>
											<ul>
												<li>long long type</li>
												<li>unsigned types for any values</li>
												<li>scientific notation</li>
											</ul>
										</ol>
										<div>
											<span class="image fit"><img src="images/C-Variable.png" alt="C Variable" /></span>
										</div>

										<h3 id="content">Additional Information</h3>
										<p>The C interpreter has some syntax differences.</p>
										<p>You can omit function call parentheses if the entire expression is the call. For example:</p>
										<pre><code class="lang-bash">
-> func &mac, 27
										</code></pre>
										<p>not:</p>
										<pre><code class="lang-bash">
-> 2 * func &mac, 27
										</code></pre>

										<p>The shell does not recognize symbolic macros.</p>
										<p>    Do not enter symbolic macros.</p>
										<pre><code class="lang-bash">
-> sem1 = semMCreate(SEM_Q_PRIORITY)
										</code></pre>
										<p>    Enter</p>
										<pre><code class="lang-bash">
-> sem1 = semMCreate(0x1)
										</code></pre>
                                                                                <blockquote>
                                                                                        <ul class="contact">
												<li class="icon solid fa-exclamation-triangle">There is no support for C control structures (for, while, if, and so on) and the shell does not recognize data structures.</li>
                                                                                        </ul>
                                                                                </blockquote>

										<section>
                                                                                        <header class="major">
												<h2>The Command interpreter in VxWorks</h2>
                                                                                        </header>
                                                                                </section>

                                                                                <h3 id="content">The Features of the Command Interpreter</h3>
										<p>Type cmd to change to the command interpreter.</p>
										<ol>
											<li>This provides the ability to monitor and debug RTPs.</li>
											<li>This interpreter mode is defined by a collection of commands.</li>
											<ul>
												<li>File commands: <b>pwd, cat, cd</b></li>
												<li>Task commands: <b>task spawn, task info, task delete</b></li>
											</ul>
											<li>Follows a UNIX-style syntax</br>
												[vxWorks *]# <b>rtp exec -s -e var=value -- cal.vxe -y</b></li>
											<li>Supports command aliasing</br>
												[vxWorks *]# <b>alias foo "task info"</b></li>
											<li>Has a special syntax for symbols</br>
												[vxWorks *]# <b>echo Address = &test Value = $test</b></li>
										</ol>

                                                                                <h3 id="content">Command Interpreter RTP Support</h3>
										<p>This is a list of the most common commands for working with RTPs:</p>
										<ul>
											<li>Launch help</br>
												-> <b>help rtp</b></li>
											<li>Launch an RTP</br>
												-> <b>rtp exec fn</b></li>
											<li>Show all RTPs</br>
												-> <b>rtp</b></li>
											<li>One RTP context</br>
												-> <b>rtp attach 0xN</b></li>
											<li>Show tasks in an attached RTP</br>
												-> <b>rtp task</b></li>
										</ul>

                                                                                <h3 id="content">Command Interpreter Functionality</h3>
										<p>The command interpreter supports common shell control characters:</p>
										<ul>
											<li>Pipe input and output (|)</br>
												[vxWorks *]# <b>cat file.txt | more</b></li>
											<li>Backquote (`) characters to evaluate a command</br>
												[vxWorks *]# <b>bp 'expr &printf + 0x4'</b></li>
											<li>Redirection for input and output (&gt; &gt;&gt; &lt;)</br>
												[vxWorks *]# <b>cat file > file2</b></br>
												[vxWorks *]# <b>/foo/bar/rtp.vxe &lt; file2 &gt;&gt; file2</b></li>
										</ul>

										<section>
                                                                                        <header class="major">
												<h2>Useful Shell Commands</h2>
                                                                                        </header>
                                                                                </section>

										<p>There are a few commands worth always having ready, these range from debugging, memory management, to analytics.</p>

                                                                                <h3 id="content">Debugging Commands</h3>
										<p>The dynamic <b>printf</b> command or <strong>dprintf</strong> is particularly useful if it is unclear where to set breakpoints, as well as to find race conditions that are hidden when the application is stopped.</p>
										<ol>
											<li>Configure the VxWorks <b>INCLUDE_DEBUG</b> component to use the C interpreter <b>dprintf()</b> and <b>hdprintf()</b> functions.</li>
											<li>Configure the VxWorks <b>INCLUDE_DEBUG_SHELL_CMD</b> component to use the command interpreter dprintf command.</li>
											<li>The dynamic <b>printf</b> command:</li>
											<ul>
												<li>Lets you install printf statements at run-time without having to recompile and reload applications or the kernel</li>
												<li>Can be used in both the kernel module or in RTP applications</li>
											</ul>
										</ol>

                                                                                <h3 id="content">System Information Commands</h3>
										<p>Displaying system information is a valuable tool when working a project, here is a list the most common commands:</p>

										<div class="table-wrapper">
											<table class="alt">
												<thead>
													<tr>
														<th></th>
														<th></th>
													</tr>
												</thead>
												<tbody>
													<tr>
														<td>devs()</td>
														<td>Lists all devices known on the target system.</td>
													</tr>
													<tr>
														<td>lkup()</td>
														<td>Takes a regular expression as an argument and will list symbols from the symbol tables.</td>
													</tr>
													<tr>
														<td>lkAddr()</td>
														<td>Takes an address as a parameter and lists the symbols whose values are near the specified address.</td>
													</tr>
													<tr>
														<td>printErrno()</td>
														<td>Describes the most recent error status value.</td>
													</tr>
												</tbody>
											</table>
										</div>

                                                                                <h3 id="content">Show Commands</h3>
										<p><b>Show</b> functions display useful information about the target system. Invoke them from the C interpreter of the kernel shell. They must include the associated component in the VIP.</p>
										<ul>
											<li>For <b>taskShow()</b>, configure the <b>INCLUDE_TASK_SHOW</b> component.</li>
											<li>For <b>memShow()</b>, configure the <b>INCLUDE_MEM_SHOW</b> component.</li>
										</ul>

										<div>
                                                                                        <span class="image fit"><img src="images/showCommands.png" alt="Show Commands" /></span>
                                                                                </div>

                                                                		<!-- Break -->

										<hr class="major" />

										<div class="row">
                                                                                        <div class="col-4 col-12-medium">
                                                                                        </div>
                                                                                        <div class="col-4 col-12-medium">
												<ul class="actions">
													<li><a href="wrap-up.html" class="button primary fit">Continue</a></li>
												</ul>
                                                                                        </div>
                                                                                        <div class="col-4 col-12-medium">
                                                                                        </div>
                                                                                </div>



						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Search -->
								<section id="search" class="alt">
									<form method="get" action="https://www.google.com/search" target="_blank">
										<input type="hidden" name="sitesearch" value="www.vxworks6.com" />
										<input type="text" name="query" id="query" placeholder="Search" />
									</form>
								</section>

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="index.html">Homepage</a></li>
										<li>
											<span class="opener">Getting started with VxWorks</span>
											<ul>
												<li><a href="the-wind-river-ecosystem.html">The Wind River Ecosystem</a></li>
												<li><a href="vxworks-key-features.html">VxWorks Key Features</a></li>
												<li><a href="workbench-4-overview.html">Workbench 4 Overview</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Target and connections overview</span>
											<ul>
												<li><a href="hardware-target-configuration.html">Hardware Target Configuration</a></li>
												<li><a href="booting-a-hardware-target.html">Booting a Hardware Target</a></li>
												<li><a href="workbench-tools-architecture.html">Workbench Tools Architecture</a></li>
												<li><a href="simulation-overview.html">Simulation Overview</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Managing Projects in Workbench</span>
											<ul>
												<li><a href="introduction-to-projects-and-workspaces.html">Introduction to Projects and Workspaces</a></li>
												<li><a href="vxworks-directory-structure-and-package-management.html">VxWorks Directory Structure and Package Management</a></li>
												<li><a href="vxworks-source-build-and-image-projects.html">VxWorks Source Build and Image Projects</a></li>
												<li><a href="the-vxprj-utility.html">The vxprj Utility</a></li>
												<li><a href="read-only-memory-file-system.html">Read-Only Memory File System</a></li>
												<li><a href="configuring-and-building-a-project.html">Configuring and Building a Project</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">VxWorks Kernel Shell</span>
											<ul>
												<li><a href="introduction-to-the-kernel-shell.html">Introduction to the Kernel Shell</a></li>
												<li><a href="command-line-editing-and-object-module-loader.html">Command-line Editing and Object-Module Loader</a></li>
												<li><a href="kernel-shell-configuration-and-commands.html">Kernel Shell Configuration and Commands</a></li>
												<li><a href="kernel-shell-usage.html">Kernel Shell Usage</a></li>
												<li><a href="wrap-up.html">Let's Wrap Up</a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Popular</h2>
									</header>
									<div class="mini-posts">
										<article>
											<a href="configuring-and-building-a-project.html" class="image"><img src="images/Configuring-and-Building-a-Project-small.png" alt="Configuring and Building a Project" /></a>
											<p>Configuring and setting up the VSB and VIP is known as platform development.</p>
										</article>
										<article>
											<a href="vxworks-key-features.html" class="image"><img src="images/VxWorks-key-features-small.png" alt="VxWorks Key Features" /></a>
											<p>VxWorks is a robust operating system; it has many useful and powerful features for you to use in your project.</p>
										</article>
										<article>
											<a href="hardware-target-configuration.html" class="image"><img src="images/Hardware-Target-Configuration-small.png" alt="Hardware Target Configuration" /></a>
											<p>All VxWorks projects are different, but they all require hardware configuration.</p>
										</article>
										<article>
											<a href="using-vxWorks-bsp-with-zynq-7000-ap-soc.html" class="image"><img src="images/soc/VxWorks-on-Zynq-UltraScale-MPSoC-small.png" alt="VxWorks BSP with Zynq 7000" /></a>
											<p>Step-by-step instructions for running the VxWorks 6.9.3.1 BSP on the Zynq-7000 SoC.</p>
										</article>
									</div>
									<ul class="actions">
										<li><a href="using-vxWorks-bsp-with-zynq-7000-ap-soc.html" class="button">More</a></li>
									</ul>
								</section>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Get in touch</h2>
									</header>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="#">admin@vxworks6.com</a></li>
									</ul>
								</section>

							<!-- Footer -->
								<footer id="footer">
                                                                        <p class="copyright">VxWorks Club &copy; <a href="https://www.vxworks.net" target="_blank">VxWorks</a></p>
								</footer>

						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
